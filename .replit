# .replit
modules = ["nodejs-22", "web"]
run = """
bash -lc '
  cd client
  echo "ðŸ”¸ cwd: $(pwd)"
  # Install client deps if missing
  if [ ! -d node_modules ]; then
    echo "ðŸ“¦ Installing client dependencies..."
    npm ci --no-audit --no-fund
  fi
  export PORT=${PORT:-3000}
  echo "ðŸ”¹ Starting Vite on port $PORT..."
  npx vite --host 0.0.0.0 --port "$PORT" --strictPort
'
"""

hidden = [
  ".config",
  ".git",
  "generated-icon.png",
  "node_modules",
  "client/node_modules",
  "dist",
  "client/dist",
]

[nix]
channel = "stable-24_05"

[env]
HOST = "0.0.0.0"

[[ports]]
localPort = 3000
externalPort = 3000

[[ports]]
localPort = 5000
externalPort = 5000

[[ports]]
localPort = 8080
externalPort = 80
